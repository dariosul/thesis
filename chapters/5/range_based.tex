\newpage
%\phantom{m}

\section{Range-based localization}


In this section we explore a sequential convex relaxation approach to the range based localization problem that you had studied in previous chapters. The localization problem discussed in this section involves a given array of $m$ sensors placed in the $n = 2$ or 3 dimensional space with coordinates specified by $\{\Ba_1,\ldots, \Ba_m, \Ba_i\in R^n\}$. Each sensor measures its distance to a radiating source $\Bx\in R^n$. Throughout it is assumed that only noisy copies of the distance data are available, hence the \textit{range measurements} obey the model
\setcounter{abc}{0}
\begin{equation} \label{eq:5.0}
\nonumber
r_i = \|{\Bx} - {\Ba}_i\| + \varepsilon_i, \quad i = 1, \ldots , m.
\end{equation}    
where $\varepsilon_i$ denotes the unknown noise that has occurred when the $i$th sensor measures its distance to source $\Bx$. %Let $\Br=[r_1 \ r_2 \ldots r_m]^T$ and $\Beps=[\varepsilon_1 \ \varepsilon_2 \ldots \varepsilon_m]^T$.  
The localization problem can be stated as to  estimate the \textit{unknown} location of the radiating device, $\Bx$, by solving the nonlinear least squares problem 
\setcounter{abc}{0}
\begin{equation} \label{eq:5.1}
\Min_{\Bx} \sum^m_i \left( \|\Bx - \Ba_i\| - r_i \right)^2 
\end{equation}

\subsection{Sequential Relaxation}

The problem in (\ref{eq:5.1}) can be (equivalently) written as 
\setcounter{abc}{0}
\begin{eqnarray} \label{eq:5.2}
\stepcounter{abc}
\Min_{\Bx, \Bz}& &\sum^m_i \left( z_i - r_i \right)^2 \\
\setcounter{equation}{11}
\stepcounter{abc}
\mbox{subject to:}& &\|\Bx - \Ba_i\| = z_i, \quad i = 1, 2, ..., m \\
\setcounter{equation}{11}
\stepcounter{abc}
& &\Bz \geq \symb{0}
\end{eqnarray}
The constraints in (\ref{eq:5.2}b) are difficult to satisfy exactly. This motivates a relaxed set of constraints that lead to the  following constrained problem
\setcounter{abc}{0}
\begin{eqnarray} \label{eq:5.3}
\setcounter{abc}{1}
\Min_{\Bx, \Bz}& &\sum^m_i \left( z_i - r_i \right)^2 \\
\setcounter{equation}{12}
\stepcounter{abc}
\mbox{subject to:}& &\|\Bx - \Ba_i\| \leq (1+ \gamma)z_i  \\
\setcounter{equation}{12}
\stepcounter{abc}
& &\|\Bx - \Ba_i\| \geq (1 - \gamma)z_i, \quad i = 1, 2, ..., m
\end{eqnarray}
where $\gamma > 0$ is a small scalar, initially set in the range $\gamma_0 \in (0,0.5)$. The solution of the problem (\ref{eq:5.3}) may be taken as an approximate solution of the problem in (\ref{eq:5.2}), hence of problem (\ref{eq:5.1}) as well. By allowing $\gamma$ to sequentially and monotonically decrease from $\gamma_0$  to zero, the solution of the problem in (\ref{eq:5.3}) converges to that of the problem in (\ref{eq:5.2}), because as $\gamma$ approaches 0, the feasible region of the problem in (\ref{eq:5.3}) will become equivalent to that in (\ref{eq:5.2}). As iterations proceed, the objective in (\ref{eq:5.3}) will not be monotonically decreasing in general but it will converge to a critical point.

Problem in (\ref{eq:5.3}) is nonconvex due to the nonconvexity of some of the inequality constraints. To be precise, the constraints in (\ref{eq:5.3}b), namely $\|\Bx - \Ba_i\| \leq (1+ \gamma)z_i$, are convex, while those in (\ref{eq:5.3}c) are not
\begin{equation}
\nonumber
\|\Bx - \Ba_i\| \geq (1 - \gamma)z_i \Longleftrightarrow \underbrace{-\|\Bx - \Ba_i\|}_{nonconvex} \leq -(1 - \gamma)z_i
\end{equation}
Because the norm $\|\Bx - \Ba_i\|$  is a convex function with respect to $\Bx$, it follows that for
a \textit{known} $\Bx_k$
\begin{equation}
\nonumber
\|\Bx - \Ba_i\| \geq \|\Bx_k - \Ba_i\| + \partial\|\Bx_k - \Ba_i\|^T(\Bx - \Bx_k)
\end{equation}
Hence the constraints in (\ref{eq:5.3}c) can be replaced with its affine approximation
\begin{equation}
\nonumber
-\|\Bx_k - \Ba_i\| - \partial\|\Bx_k - \Ba_i\|^T(\Bx - \Bx_k) \leq -(1 - \gamma)z_i
\end{equation}
In this way, in the $k$th iteration when the iterate $\Bx_k$ is known, the nonconvex problem in (\ref{eq:5.3}) can be converted to a convex second-order cone
programming (SOCP) problem
\setcounter{abc}{0}
\begin{eqnarray} \label{eq:5.4}
\stepcounter{abc}
\Min_{\Bx, \Bz}& &\sum^m_i \left( z_i - r_i \right)^2 \\
\setcounter{equation}{13}
\stepcounter{abc}
\mbox{subject to:}& &\|\Bx - \Ba_i\|  \leq  (1+ \gamma)z_i  
\end{eqnarray}
\begin{equation}
\setcounter{equation}{13}
\stepcounter{abc}
\qquad \qquad \qquad  -\|\Bx_k - \Ba_i\| - \partial\|\Bx_k -\Ba_i\|^T(\Bx - \Bx_k)  \leq  -(1 - \gamma)z_i, \quad i = 1, 2, ..., m
\end{equation}
\setcounter{abc}{0}
where the relaxation parameter $\gamma$ controls the size of the convex hull that defines a feasibility region of the problem (\ref{eq:5.4}), and $\gamma$ needs to be monotonically decreasing as the iteration proceeds. Specifically, a reasonable choice of the value for $\gamma_0$ is 0.2 or 0.3, and we update the value of $\gamma_{k+1}$ linearly as
\setcounter{abc}{0}
\begin{equation} \label{eq:lin}
\gamma_{k+1} = \gamma_0 - k\frac{\gamma_0}{K_{max} - 1}
\end{equation}
or quadratically as
\begin{equation} \label{eq:quad}
\gamma_{k+1} = \gamma_0\frac{(K_{max} - 1 - k)^2}{(K_{max} - 1)^2}
\end{equation}
where $K_{max}$ is the number of iterations to be executed.

For the ease of notation the proposed algorithm will be referred to as Sequential Convex Relaxation for Range-based Least Squares (SCR-RLS). It is important to note that the SCR-RLS is a local method and its performance often depend on the choice of the initial point. Several available techniques described in Sec.4.1.3 of the thesis can be applied here. Summarizing the analysis above, the localization algorithm based on range measurements can be outlined as follows.

\phantom{m}
\framebox{%
\parbox{5.4in}{
\label{alg:scp_r}
\phantom{m}

\noindent \textbf{Algorithm 5. Sequential Convex Relaxation for Range-based Localization}

\phantom{m}

1) Input data: Sensor locations $\{\Ba_i,  i=1,\ldots,m\}$, range measurements $\{r_i, i=1,\ldots,m\}$, initial point $\Bx_0$, initial relaxation parameter $\gamma_0$, and the number of iterations to be executed $K_{max}$. %\gamma, \sigma$, 
Set iteration count to $k = 0$.
 
%\phantom{m}

2) Solve
\setcounter{abc}{0}
\begin{eqnarray} 
\nonumber
\Min_{\Bx, \Bz}& &\sum^m_i \left( z_i - r_i \right)^2 \\
\nonumber
\mbox{subject to:}& &\|\Bx - \Ba_i\|  \leq  (1+ \gamma)z_i  
\end{eqnarray}
\begin{equation}
\nonumber
\qquad \quad   -\|\Bx_k - \Ba_i\| - \partial\|\Bx_k -\Ba_i\|^T(\Bx - \Ba_i)  \leq  -(1 - \gamma)z_i, \ i = 1, 2, ..., m
\end{equation}
%\phantom{m}
\noindent
Denote the solution as $\tilde{\Bx}_k = (\Bx^*, \Bz^*)$. 

%\phantom{m}

3) Update  $\gamma_{k+1} = f(\gamma_k)$ linearly, as in (\ref{eq:lin}), or quadratically, as in (\ref{eq:quad}). Set $k = k+1$. 

%\phantom{m}

4) If $k = K_{max}$, terminate and output $\Bx^*$ as the solution; otherwise, set $\Bx_{k} = \Bx^{*}$  and repeat from Step 2. 

\phantom{m}
}
}

\phantom{m}

\subsection{Numerical Results}

Performance of the proposed SCR-RLS algorithm was evaluated and compared with existing state-of-the-art SR-LS solutions \cite{BeckStLi} with a set-up similar to that of \cite{BeckStLi}.   Our simulation studies of Algorithm 5 considered a scenario that consists of  $m = 5$ sensors $\{\Ba_i, \ i=1, 2,\ldots,m\}$ randomly placed in the planar region in $[-15;15]\times[-15;15]$, and a radiating source $\Bx_s$, located randomly in the region $[-10;10]\times[-10;10]$. Coordinates of the source and sensors were generated for each dimension following a uniform distribution. 
Measurement noise $\{\varepsilon_i, \ i=1,\ldots, m\}$ was modelled as i.i.d. Gaussian random variables with zero mean and variance $\sigma^2$, with $\sigma$ being one of three possible levels $\{10^{-2}, 10^{-1}, 10^{0}\}$. The range measurements $\{r_i, \ i=1, 2,\ldots, m\}$ were calculated using 
\setcounter{abc}{0}
\begin{equation} \label{eq:5.0}
\nonumber
r_i = \|{\Bx} - {\Ba}_i\| + \varepsilon_i, \quad i = 1, \ldots , m.
\end{equation}
Accuracy of source location estimation was evaluated as the average of the squared position error $\|\Bx^* - \Bx_s\|^2$ where $\Bx_s$ denotes the exact source location and $\Bx^*$ is its estimation obtained by SR-LS and SCR-RLS methods, respectively. Implementation of SR-LS followed \cite{BeckStLi} and the method proposed in this section was implemented using CVX \cite{cvx}. In our simulations, we set the value of $\gamma_0$ to 0.2 and the number of iterations $K_{max}$ to 9. The SCR-RLS algorithm was initialized with the midpoint between the two sensors associated with the two smallest distance readings. 


Table \ref{tab:scr_rls} provides comparisons of the proposed sequential relaxation method with SR-LS, where each table entry is a squared error averaged over 200 Monte Carlo runs of a given method for a given noise level. The last column of the table  represents relative improvement (R.I.) of the proposed method over SR-LS solutions in percentage. %It is observed that SCR-RLS solutions offer considerable improvement over SR-LS solutions.
Table \ref{tab:rls} compares a standard deviation of the squared  estimation errors  aggregated over the  same 200 Monte Carlo runs described above in Table \ref{tab:scr_rls} where the MSE of the position estimation are shown. The results
summarized in  Table \ref{tab:scr_rls} and Table \ref{tab:rls} indicate that the SCR-RLS algorithm yields improved performance relative to the SR-LS algorithm.

%\phantom{m}

\begin{table*}[h]
\centering
\caption{MSE of position estimation for SR-LS and SCR-RLS methods}
\phantom{m}
\begin{tabular}{|c|c|c|c|} \hline
\centering
$\sigma$ & SR - LS & SCR-RLS & (R.I.,\%)  \\ \hline
%&&& \\
1e-02&	2.5360e-04 & 2.0596e-04 &  18 \\ &&&\\
1e-01&	1.8696e-02  & 1.4802e-02 & 21   \\ &&&\\
1e+0&	1.4440e+00 & 9.6327e-01 &  33   \\ %&&&\\
\hline
\end{tabular}
\label{tab:scr_rls}
\end{table*}


\newpage

\begin{table*}[h]
\centering
\caption{Standard deviation of the squared position estimation error for SR-LS and SCR-RLS methods}
\phantom{m}
\begin{tabular}{|c|c|c|c|} \hline
\centering
$\sigma$ & SR - LS & SCR-RLS  \\ \hline
%&&& \\
1e-02&	1.1711e-03  & 3.7880e-04  \\ &&\\
1e-01&	3.5513e-02 & 2.4685e-02    \\ &&\\
1e+0&	1.7519e+00  & 9.6863e-01   \\ %&&&\\
\hline
\end{tabular}
\label{tab:rls}
\end{table*}

%\startchapter{SOCP}
%\newpage
